{"filter":false,"title":"jquery.stellar.min.js","tooltip":"/js/jquery.stellar.min.js","undoManager":{"mark":0,"position":0,"stack":[[{"group":"doc","deltas":[{"start":{"row":0,"column":0},"end":{"row":1,"column":11959},"action":"remove","lines":["/*! Stellar.js v0.3 | Copyright 2012, Mark Dalgleish | http://markdalgleish.com/projects/stellar.js | http://markdalgleish.mit-license.org */","(function(a,b,c,d){function l(b,c){this.element=b,this.options=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e=\"stellar\",f={scrollProperty:\"scroll\",positionProperty:\"position\",horizontalScrolling:!0,verticalScrolling:!0,horizontalOffset:0,verticalOffset:0,parallaxBackgrounds:!0,parallaxElements:!0,hideDistantElements:!0,viewportDetectionInterval:1e4,hideElement:function(a){a.hide()},showElement:function(a){a.show()}},g={scroll:{getTop:function(a){return a.scrollTop()},setTop:function(a,b){a.scrollTop(b)},getLeft:function(a){return a.scrollLeft()},setLeft:function(a,b){a.scrollLeft(b)}},position:{getTop:function(a){return parseInt(a.css(\"top\"),10)*-1},setTop:function(a,b){a.css(\"top\",b)},getLeft:function(a){return parseInt(a.css(\"left\"),10)*-1},setLeft:function(a,b){a.css(\"left\",b)}},margin:{getTop:function(a){return parseInt(a.css(\"margin-top\"),10)*-1},setTop:function(a,b){a.css(\"margin-top\",b)},getLeft:function(a){return parseInt(a.css(\"margin-left\"),10)*-1},setLeft:function(a,b){a.css(\"margin-left\",b)}},transform:{getTop:function(a){return a.css(i+\"transform\")!==\"none\"?parseInt(a.css(i+\"transform\").match(/(-?[0-9]+)/g)[5],10)*-1:0},setTop:function(a,b){j(a,b,\"Y\")},getLeft:function(a){return a.css(i+\"transform\")!==\"none\"?parseInt(a.css(i+\"transform\").match(/(-?[0-9]+)/g)[4],10)*-1:0},setLeft:function(a,b){j(a,b,\"X\")}}},h={position:{setTop:function(a,b){a.css(\"top\",b)},setLeft:function(a,b){a.css(\"left\",b)}},transform:{setTop:function(a,b,c){j(a,b-c,\"Y\")},setLeft:function(a,b,c){j(a,b-c,\"X\")}}},i=function(){var b=\"\";return a.browser.webkit?b=\"-webkit-\":a.browser.mozilla?b=\"-moz-\":a.browser.opera?b=\"-o-\":a.browser.msie&&(b=\"-ms-\"),b}(),j=function(a,b,c){var d=a.css(i+\"transform\");d===\"none\"?a.css(i+\"transform\",\"translate\"+c+\"(\"+b+\"px)\"):a.css(i+\"transform\",k(d,/(-?[0-9]+[.]?[0-9]*)/g,c===\"X\"?5:6,b))},k=function(a,b,c,e){var f,g,h;return a.search(b)===-1?a:(f=a.split(b),h=c*2-1,f[h]===d?a:(f[h]=e,f.join(\"\")))};l.prototype={init:function(){this.options.name=e+\"_\"+Math.floor(Math.random()*1e4),this._defineElements(),this._defineGetters(),this._defineSetters(),this.refresh(),this._startViewportDetectionLoop(),this._startAnimationLoop()},_defineElements:function(){this.element===c.body&&(this.element=b),this.$scrollElement=a(this.element),this.$element=this.element===b?a(\"body\"):this.$scrollElement,this.$viewportElement=this.options.viewportElement!==d?a(this.options.viewportElement):this.$scrollElement[0]===b||this.options.scrollProperty.indexOf(\"scroll\")===0?this.$scrollElement:this.$scrollElement.parent()},_defineGetters:function(){var a=this;this._getScrollLeft=function(){return g[a.options.scrollProperty].getLeft(a.$scrollElement)},this._getScrollTop=function(){return g[a.options.scrollProperty].getTop(a.$scrollElement)}},_defineSetters:function(){var a=this;this._setScrollLeft=function(b){g[a.options.scrollProperty].setLeft(a.$scrollElement,b)},this._setScrollTop=function(b){g[a.options.scrollProperty].setTop(a.$scrollElement,b)},this._setLeft=function(b,c,d){h[a.options.positionProperty].setLeft(b,c,d)},this._setTop=function(b,c,d){h[a.options.positionProperty].setTop(b,c,d)}},refresh:function(){var c=this,d=c._getScrollLeft(),e=c._getScrollTop();this._setScrollLeft(0),this._setScrollTop(0),this._setOffsets(),this._findParticles(),this._findBackgrounds(),navigator.userAgent.indexOf(\"WebKit\")>0&&a(b).load(function(){var a=c._getScrollLeft(),b=c._getScrollTop();c._setScrollLeft(a+1),c._setScrollTop(b+1),c._setScrollLeft(a),c._setScrollTop(b)}),c._setScrollLeft(d),c._setScrollTop(e)},_findParticles:function(){var b=this,c=this._getScrollLeft(),e=this._getScrollTop();if(this.particles!==d)for(var f=this.particles.length-1;f>=0;f--)this.particles[f].$element.data(\"stellar-elementIsActive\",d);this.particles=[];if(!this.options.parallaxElements)return;this.$element.find(\"[data-stellar-ratio]\").each(function(c){var e=a(this),f,g,h,i,j,k,l,m,n,o=0,p=0,q=0,r=0;if(!e.data(\"stellar-elementIsActive\"))e.data(\"stellar-elementIsActive\",this);else if(e.data(\"stellar-elementIsActive\")!==this)return;b.options.showElement(e),e.data(\"stellar-startingLeft\")?(e.css(\"left\",e.data(\"stellar-startingLeft\")),e.css(\"top\",e.data(\"stellar-startingTop\"))):(e.data(\"stellar-startingLeft\",e.css(\"left\")),e.data(\"stellar-startingTop\",e.css(\"top\"))),h=e.position().left,i=e.position().top,j=e.css(\"margin-left\")===\"auto\"?0:parseInt(e.css(\"margin-left\"),10),k=e.css(\"margin-top\")===\"auto\"?0:parseInt(e.css(\"margin-top\"),10),m=e.offset().left-j,n=e.offset().top-k,e.parents().each(function(){var b=a(this);if(b.data(\"stellar-offset-parent\")===!0)return o=q,p=r,l=b,!1;q+=b.position().left,r+=b.position().top}),f=e.data(\"stellar-horizontal-offset\")!==d?e.data(\"stellar-horizontal-offset\"):l!==d&&l.data(\"stellar-horizontal-offset\")!==d?l.data(\"stellar-horizontal-offset\"):b.horizontalOffset,g=e.data(\"stellar-vertical-offset\")!==d?e.data(\"stellar-vertical-offset\"):l!==d&&l.data(\"stellar-vertical-offset\")!==d?l.data(\"stellar-vertical-offset\"):b.verticalOffset,b.particles.push({$element:e,$offsetParent:l,isFixed:e.css(\"position\")===\"fixed\",horizontalOffset:f,verticalOffset:g,startingPositionLeft:h,startingPositionTop:i,startingOffsetLeft:m,startingOffsetTop:n,parentOffsetLeft:o,parentOffsetTop:p,stellarRatio:e.data(\"stellar-ratio\")!==d?e.data(\"stellar-ratio\"):1,width:e.outerWidth(!0),height:e.outerHeight(!0),isHidden:!1})})},_findBackgrounds:function(){var b=this,c=this._getScrollLeft(),e=this._getScrollTop(),f;this.backgrounds=[];if(!this.options.parallaxBackgrounds)return;f=this.$element.find(\"[data-stellar-background-ratio]\"),this.$element.is(\"[data-stellar-background-ratio]\")&&f.add(this.$element),f.each(function(){var f=a(this),g=f.css(\"background-position\").split(\" \"),h,i,j,k,l,m,n,o,p,q=0,r=0,s=0,t=0;if(!f.data(\"stellar-backgroundIsActive\"))f.data(\"stellar-backgroundIsActive\",this);else if(f.data(\"stellar-backgroundIsActive\")!==this)return;f.data(\"stellar-backgroundStartingLeft\")?f.css(\"background-position\",f.data(\"stellar-backgroundStartingLeft\")+\" \"+f.data(\"stellar-backgroundStartingTop\")):(f.data(\"stellar-backgroundStartingLeft\",g[0]),f.data(\"stellar-backgroundStartingTop\",g[1])),l=f.css(\"margin-left\")===\"auto\"?0:parseInt(f.css(\"margin-left\"),10),m=f.css(\"margin-top\")===\"auto\"?0:parseInt(f.css(\"margin-top\"),10),n=f.offset().left-l-c,o=f.offset().top-m-e,f.parents().each(function(){var b=a(this);if(b.data(\"stellar-offset-parent\")===!0)return q=s,r=t,p=b,!1;s+=b.position().left,t+=b.position().top}),h=f.data(\"stellar-horizontal-offset\")!==d?f.data(\"stellar-horizontal-offset\"):p!==d&&p.data(\"stellar-horizontal-offset\")!==d?p.data(\"stellar-horizontal-offset\"):b.horizontalOffset,i=f.data(\"stellar-vertical-offset\")!==d?f.data(\"stellar-vertical-offset\"):p!==d&&p.data(\"stellar-vertical-offset\")!==d?p.data(\"stellar-vertical-offset\"):b.verticalOffset,b.backgrounds.push({$element:f,$offsetParent:p,isFixed:f.css(\"background-attachment\")===\"fixed\",horizontalOffset:h,verticalOffset:i,startingValueLeft:g[0],startingValueTop:g[1],startingBackgroundPositionLeft:isNaN(parseInt(g[0],10))?0:parseInt(g[0],10),startingBackgroundPositionTop:isNaN(parseInt(g[1],10))?0:parseInt(g[1],10),startingPositionLeft:f.position().left,startingPositionTop:f.position().top,startingOffsetLeft:n,startingOffsetTop:o,parentOffsetLeft:q,parentOffsetTop:r,stellarRatio:f.data(\"stellar-background-ratio\")===d?1:f.data(\"stellar-background-ratio\")})})},destroy:function(){var b,c,d,e,f;for(f=this.particles.length-1;f>=0;f--)b=this.particles[f],c=b.$element.data(\"stellar-startingLeft\"),d=b.$element.data(\"stellar-startingTop\"),this._setLeft(b.$element,c,c),this._setTop(b.$element,d,d),this.options.showElement(b.$element),b.$element.data(\"stellar-startingLeft\",null).data(\"stellar-elementIsActive\",null).data(\"stellar-backgroundIsActive\",null);for(f=this.backgrounds.length-1;f>=0;f--)e=this.backgrounds[f],e.$element.css(\"background-position\",e.startingValueLeft+\" \"+e.startingValueTop);this._animationLoop=a.noop,clearInterval(this._viewportDetectionInterval)},_setOffsets:function(){var c=this;a(b).unbind(\"resize.horizontal-\"+this.name).unbind(\"resize.vertical-\"+this.name),typeof this.options.horizontalOffset==\"function\"?(this.horizontalOffset=this.options.horizontalOffset(),a(b).bind(\"resize.horizontal-\"+this.name,function(){c.horizontalOffset=c.options.horizontalOffset()})):this.horizontalOffset=this.options.horizontalOffset,typeof this.options.verticalOffset==\"function\"?(this.verticalOffset=this.options.verticalOffset(),a(b).bind(\"resize.vertical-\"+this.name,function(){c.verticalOffset=c.options.verticalOffset()})):this.verticalOffset=this.options.verticalOffset},_repositionElements:function(){var a=this._getScrollLeft(),b=this._getScrollTop(),c,d,e,f,g,h,i,j=!0,k=!0,l,m,n,o,p;if(this.currentScrollLeft===a&&this.currentScrollTop===b&&this.currentWidth===this.viewportWidth&&this.currentHeight===this.viewportHeight)return;this.currentScrollLeft=a,this.currentScrollTop=b,this.currentWidth=this.viewportWidth,this.currentHeight=this.viewportHeight;for(p=this.particles.length-1;p>=0;p--)e=this.particles[p],f=e.isFixed?1:0,this.options.horizontalScrolling&&(l=(a+e.horizontalOffset+this.viewportOffsetLeft+e.startingPositionLeft-e.startingOffsetLeft+e.parentOffsetLeft)*-(e.stellarRatio+f-1)+e.startingPositionLeft,n=l-e.startingPositionLeft+e.startingOffsetLeft),this.options.verticalScrolling&&(m=(b+e.verticalOffset+this.viewportOffsetTop+e.startingPositionTop-e.startingOffsetTop+e.parentOffsetTop)*-(e.stellarRatio+f-1)+e.startingPositionTop,o=m-e.startingPositionTop+e.startingOffsetTop),this.options.hideDistantElements&&(k=!this.options.horizontalScrolling||n+e.width>(e.isFixed?0:a)&&n<(e.isFixed?0:a)+this.viewportWidth+this.viewportOffsetLeft,j=!this.options.verticalScrolling||o+e.height>(e.isFixed?0:b)&&o<(e.isFixed?0:b)+this.viewportHeight+this.viewportOffsetTop),k&&j?(e.isHidden&&(this.options.showElement(e.$element),e.isHidden=!1),this.options.horizontalScrolling&&this._setLeft(e.$element,l,e.startingPositionLeft),this.options.verticalScrolling&&this._setTop(e.$element,m,e.startingPositionTop)):e.isHidden||(this.options.hideElement(e.$element),e.isHidden=!0);for(p=this.backgrounds.length-1;p>=0;p--)g=this.backgrounds[p],f=g.isFixed?0:1,h=this.options.horizontalScrolling?(a+g.horizontalOffset-this.viewportOffsetLeft-g.startingOffsetLeft+g.parentOffsetLeft-g.startingBackgroundPositionLeft)*(f-g.stellarRatio)+\"px\":g.startingValueLeft,i=this.options.verticalScrolling?(b+g.verticalOffset-this.viewportOffsetTop-g.startingOffsetTop+g.parentOffsetTop-g.startingBackgroundPositionTop)*(f-g.stellarRatio)+\"px\":g.startingValueTop,g.$element.css(\"background-position\",h+\" \"+i)},_startViewportDetectionLoop:function(){var a=this,b=function(){var b=a.$viewportElement.offset();a.viewportWidth=a.$viewportElement.width(),a.viewportHeight=a.$viewportElement.height(),a.viewportOffsetTop=b!==null?b.top:0,a.viewportOffsetLeft=b!==null?b.left:0};b(),this._viewportDetectionInterval=setInterval(b,this.options.viewportDetectionInterval)},_startAnimationLoop:function(){var a=this,c=function(){return b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.oRequestAnimationFrame||b.msRequestAnimationFrame||function(a,c){b.setTimeout(a,1e3/60)}}();this._animationLoop=function(){c(a._animationLoop),a._repositionElements()},this._animationLoop()}},a.fn[e]=function(b){var c=arguments;if(b===d||typeof b==\"object\")return this.each(function(){a.data(this,\"plugin_\"+e)||a.data(this,\"plugin_\"+e,new l(this,b))});if(typeof b==\"string\"&&b[0]!==\"_\"&&b!==\"init\")return this.each(function(){var d=a.data(this,\"plugin_\"+e);d instanceof l&&typeof d[b]==\"function\"&&d[b].apply(d,Array.prototype.slice.call(c,1)),b===\"destroy\"&&a.data(this,\"plugin_\"+e,null)})},a[e]=function(c){var d=a(b);return d.stellar.apply(d,Array.prototype.slice.call(arguments,0))},a[e].scrollProperty=g,a[e].positionProperty=h,b.Stellar=l})(jQuery,window,document);"]},{"start":{"row":0,"column":0},"end":{"row":552,"column":27},"action":"insert","lines":[";(function($, window, document, undefined) {","var pluginName = 'stellar',","defaults = {","scrollProperty: 'scroll',","positionProperty: 'position',","horizontalScrolling: true,","verticalScrolling: true,","horizontalOffset: 0,","verticalOffset: 0,","responsive: false,","parallaxBackgrounds: true,","parallaxElements: true,","hideDistantElements: true,","hideElement: function($elem) { $elem.hide(); },","showElement: function($elem) { $elem.show(); }","},","scrollProperty = {","scroll: {","getLeft: function($elem) { return $elem.scrollLeft(); },","setLeft: function($elem, val) { $elem.scrollLeft(val); },","getTop: function($elem) { return $elem.scrollTop(); },","setTop: function($elem, val) { $elem.scrollTop(val); }","},","position: {","getLeft: function($elem) { return parseInt($elem.css('left'), 10) * -1; },","getTop: function($elem) { return parseInt($elem.css('top'), 10) * -1; }","},","margin: {","getLeft: function($elem) { return parseInt($elem.css('margin-left'), 10) * -1; },","getTop: function($elem) { return parseInt($elem.css('margin-top'), 10) * -1; }","},","transform: {","getLeft: function($elem) {","var computedTransform = getComputedStyle($elem[0])[prefixedTransform];","return (computedTransform !== 'none' ? parseInt(computedTransform.match(/(-?[0-9]+)/g)[4], 10) * -1 : 0);","},","getTop: function($elem) {","var computedTransform = getComputedStyle($elem[0])[prefixedTransform];","return (computedTransform !== 'none' ? parseInt(computedTransform.match(/(-?[0-9]+)/g)[5], 10) * -1 : 0);","}","}","},","positionProperty = {","position: {","setLeft: function($elem, left) { $elem.css('left', left); },","setTop: function($elem, top) { $elem.css('top', top); }","},","transform: {","setPosition: function($elem, left, startingLeft, top, startingTop) {","$elem[0].style[prefixedTransform] = 'translate3d(' + (left - startingLeft) + 'px, ' + (top - startingTop) + 'px, 0)';","}","}","},","// Returns a function which adds a vendor prefix to any CSS property name","vendorPrefix = (function() {","var prefixes = /^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,","style = $('script')[0].style,","prefix = '',","prop;","for (prop in style) {","if (prefixes.test(prop)) {","prefix = prop.match(prefixes)[0];","break;","}","}","if ('WebkitOpacity' in style) { prefix = 'Webkit'; }","if ('KhtmlOpacity' in style) { prefix = 'Khtml'; }","return function(property) {","return prefix + (prefix.length > 0 ? property.charAt(0).toUpperCase() + property.slice(1) : property);","};","}()),","prefixedTransform = vendorPrefix('transform'),","supportsBackgroundPositionXY = $('<div />', { style: 'background:#fff' }).css('background-position-x') !== undefined,","setBackgroundPosition = (supportsBackgroundPositionXY ?","function($elem, x, y) {","$elem.css({","'background-position-x': x,","'background-position-y': y","});","} :","function($elem, x, y) {","$elem.css('background-position', x + ' ' + y);","}","),","getBackgroundPosition = (supportsBackgroundPositionXY ?","function($elem) {","return [","$elem.css('background-position-x'),","$elem.css('background-position-y')","];","} :","function($elem) {","return $elem.css('background-position').split(' ');","}","),","requestAnimFrame = (","window.requestAnimationFrame ||","window.webkitRequestAnimationFrame ||","window.mozRequestAnimationFrame ||","window.oRequestAnimationFrame ||","window.msRequestAnimationFrame ||","function(callback) {","setTimeout(callback, 1000 / 60);","}",");","function Plugin(element, options) {","this.element = element;","this.options = $.extend({}, defaults, options);","this._defaults = defaults;","this._name = pluginName;","this.init();","}","Plugin.prototype = {","init: function() {","this.options.name = pluginName + '_' + Math.floor(Math.random() * 1e9);","this._defineElements();","this._defineGetters();","this._defineSetters();","this._handleWindowLoadAndResize();","this._detectViewport();","this.refresh({ firstLoad: true });","if (this.options.scrollProperty === 'scroll') {","this._handleScrollEvent();","} else {","this._startAnimationLoop();","}","},","_defineElements: function() {","if (this.element === document.body) this.element = window;","this.$scrollElement = $(this.element);","this.$element = (this.element === window ? $('body') : this.$scrollElement);","this.$viewportElement = (this.options.viewportElement !== undefined ? $(this.options.viewportElement) : (this.$scrollElement[0] === window || this.options.scrollProperty === 'scroll' ? this.$scrollElement : this.$scrollElement.parent()) );","},","_defineGetters: function() {","var self = this,","scrollPropertyAdapter = scrollProperty[self.options.scrollProperty];","this._getScrollLeft = function() {","return scrollPropertyAdapter.getLeft(self.$scrollElement);","};","this._getScrollTop = function() {","return scrollPropertyAdapter.getTop(self.$scrollElement);","};","},","_defineSetters: function() {","var self = this,","scrollPropertyAdapter = scrollProperty[self.options.scrollProperty],","positionPropertyAdapter = positionProperty[self.options.positionProperty],","setScrollLeft = scrollPropertyAdapter.setLeft,","setScrollTop = scrollPropertyAdapter.setTop;","this._setScrollLeft = (typeof setScrollLeft === 'function' ? function(val) {","setScrollLeft(self.$scrollElement, val);","} : $.noop);","this._setScrollTop = (typeof setScrollTop === 'function' ? function(val) {","setScrollTop(self.$scrollElement, val);","} : $.noop);","this._setPosition = positionPropertyAdapter.setPosition ||","function($elem, left, startingLeft, top, startingTop) {","if (self.options.horizontalScrolling) {","positionPropertyAdapter.setLeft($elem, left, startingLeft);","}","if (self.options.verticalScrolling) {","positionPropertyAdapter.setTop($elem, top, startingTop);","}","};","},","_handleWindowLoadAndResize: function() {","var self = this,","$window = $(window);","if (self.options.responsive) {","$window.bind('load.' + this.name, function() {","self.refresh();","});","}","$window.bind('resize.' + this.name, function() {","self._detectViewport();","if (self.options.responsive) {","self.refresh();","}","});","},","refresh: function(options) {","var self = this,","oldLeft = self._getScrollLeft(),","oldTop = self._getScrollTop();","if (!options || !options.firstLoad) {","this._reset();","}","this._setScrollLeft(0);","this._setScrollTop(0);","this._setOffsets();","this._findParticles();","this._findBackgrounds();","// Fix for WebKit background rendering bug","if (options && options.firstLoad && /WebKit/.test(navigator.userAgent)) {","$(window).load(function() {","var oldLeft = self._getScrollLeft(),","oldTop = self._getScrollTop();","self._setScrollLeft(oldLeft + 1);","self._setScrollTop(oldTop + 1);","self._setScrollLeft(oldLeft);","self._setScrollTop(oldTop);","});","}","this._setScrollLeft(oldLeft);","this._setScrollTop(oldTop);","},","_detectViewport: function() {","var viewportOffsets = this.$viewportElement.offset(),","hasOffsets = viewportOffsets !== null && viewportOffsets !== undefined;","this.viewportWidth = this.$viewportElement.width();","this.viewportHeight = this.$viewportElement.height();","this.viewportOffsetTop = (hasOffsets ? viewportOffsets.top : 0);","this.viewportOffsetLeft = (hasOffsets ? viewportOffsets.left : 0);","},","_findParticles: function() {","var self = this,","scrollLeft = this._getScrollLeft(),","scrollTop = this._getScrollTop();","if (this.particles !== undefined) {","for (var i = this.particles.length - 1; i >= 0; i--) {","this.particles[i].$element.data('stellar-elementIsActive', undefined);","}","}","this.particles = [];","if (!this.options.parallaxElements) return;","this.$element.find('[data-stellar-ratio]').each(function(i) {","var $this = $(this),","horizontalOffset,","verticalOffset,","positionLeft,","positionTop,","marginLeft,","marginTop,","$offsetParent,","offsetLeft,","offsetTop,","parentOffsetLeft = 0,","parentOffsetTop = 0,","tempParentOffsetLeft = 0,","tempParentOffsetTop = 0;","// Ensure this element isn't already part of another scrolling element","if (!$this.data('stellar-elementIsActive')) {","$this.data('stellar-elementIsActive', this);","} else if ($this.data('stellar-elementIsActive') !== this) {","return;","}","self.options.showElement($this);","// Save/restore the original top and left CSS values in case we refresh the particles or destroy the instance","if (!$this.data('stellar-startingLeft')) {","$this.data('stellar-startingLeft', $this.css('left'));","$this.data('stellar-startingTop', $this.css('top'));","} else {","$this.css('left', $this.data('stellar-startingLeft'));","$this.css('top', $this.data('stellar-startingTop'));","}","positionLeft = $this.position().left;","positionTop = $this.position().top;","// Catch-all for margin top/left properties (these evaluate to 'auto' in IE7 and IE8)","marginLeft = ($this.css('margin-left') === 'auto') ? 0 : parseInt($this.css('margin-left'), 10);","marginTop = ($this.css('margin-top') === 'auto') ? 0 : parseInt($this.css('margin-top'), 10);","offsetLeft = $this.offset().left - marginLeft;","offsetTop = $this.offset().top - marginTop;","// Calculate the offset parent","$this.parents().each(function() {","var $this = $(this);","if ($this.data('stellar-offset-parent') === true) {","parentOffsetLeft = tempParentOffsetLeft;","parentOffsetTop = tempParentOffsetTop;","$offsetParent = $this;","return false;","} else {","tempParentOffsetLeft += $this.position().left;","tempParentOffsetTop += $this.position().top;","}","});","// Detect the offsets","horizontalOffset = ($this.data('stellar-horizontal-offset') !== undefined ? $this.data('stellar-horizontal-offset') : ($offsetParent !== undefined && $offsetParent.data('stellar-horizontal-offset') !== undefined ? $offsetParent.data('stellar-horizontal-offset') : self.horizontalOffset));","verticalOffset = ($this.data('stellar-vertical-offset') !== undefined ? $this.data('stellar-vertical-offset') : ($offsetParent !== undefined && $offsetParent.data('stellar-vertical-offset') !== undefined ? $offsetParent.data('stellar-vertical-offset') : self.verticalOffset));","// Add our object to the particles collection","self.particles.push({","$element: $this,","$offsetParent: $offsetParent,","isFixed: $this.css('position') === 'fixed',","horizontalOffset: horizontalOffset,","verticalOffset: verticalOffset,","startingPositionLeft: positionLeft,","startingPositionTop: positionTop,","startingOffsetLeft: offsetLeft,","startingOffsetTop: offsetTop,","parentOffsetLeft: parentOffsetLeft,","parentOffsetTop: parentOffsetTop,","stellarRatio: ($this.data('stellar-ratio') !== undefined ? $this.data('stellar-ratio') : 1),","width: $this.outerWidth(true),","height: $this.outerHeight(true),","isHidden: false","});","});","},","_findBackgrounds: function() {","var self = this,","scrollLeft = this._getScrollLeft(),","scrollTop = this._getScrollTop(),","$backgroundElements;","this.backgrounds = [];","if (!this.options.parallaxBackgrounds) return;","$backgroundElements = this.$element.find('[data-stellar-background-ratio]');","if (this.$element.data('stellar-background-ratio')) {","$backgroundElements = $backgroundElements.add(this.$element);","}","$backgroundElements.each(function() {","var $this = $(this),","backgroundPosition = getBackgroundPosition($this),","horizontalOffset,","verticalOffset,","positionLeft,","positionTop,","marginLeft,","marginTop,","offsetLeft,","offsetTop,","$offsetParent,","parentOffsetLeft = 0,","parentOffsetTop = 0,","tempParentOffsetLeft = 0,","tempParentOffsetTop = 0;","// Ensure this element isn't already part of another scrolling element","if (!$this.data('stellar-backgroundIsActive')) {","$this.data('stellar-backgroundIsActive', this);","} else if ($this.data('stellar-backgroundIsActive') !== this) {","return;","}","// Save/restore the original top and left CSS values in case we destroy the instance","if (!$this.data('stellar-backgroundStartingLeft')) {","$this.data('stellar-backgroundStartingLeft', backgroundPosition[0]);","$this.data('stellar-backgroundStartingTop', backgroundPosition[1]);","} else {","setBackgroundPosition($this, $this.data('stellar-backgroundStartingLeft'), $this.data('stellar-backgroundStartingTop'));","}","// Catch-all for margin top/left properties (these evaluate to 'auto' in IE7 and IE8)","marginLeft = ($this.css('margin-left') === 'auto') ? 0 : parseInt($this.css('margin-left'), 10);","marginTop = ($this.css('margin-top') === 'auto') ? 0 : parseInt($this.css('margin-top'), 10);","offsetLeft = $this.offset().left - marginLeft - scrollLeft;","offsetTop = $this.offset().top - marginTop - scrollTop;","// Calculate the offset parent","$this.parents().each(function() {","var $this = $(this);","if ($this.data('stellar-offset-parent') === true) {","parentOffsetLeft = tempParentOffsetLeft;","parentOffsetTop = tempParentOffsetTop;","$offsetParent = $this;","return false;","} else {","tempParentOffsetLeft += $this.position().left;","tempParentOffsetTop += $this.position().top;","}","});","// Detect the offsets","horizontalOffset = ($this.data('stellar-horizontal-offset') !== undefined ? $this.data('stellar-horizontal-offset') : ($offsetParent !== undefined && $offsetParent.data('stellar-horizontal-offset') !== undefined ? $offsetParent.data('stellar-horizontal-offset') : self.horizontalOffset));","verticalOffset = ($this.data('stellar-vertical-offset') !== undefined ? $this.data('stellar-vertical-offset') : ($offsetParent !== undefined && $offsetParent.data('stellar-vertical-offset') !== undefined ? $offsetParent.data('stellar-vertical-offset') : self.verticalOffset));","self.backgrounds.push({","$element: $this,","$offsetParent: $offsetParent,","isFixed: $this.css('background-attachment') === 'fixed',","horizontalOffset: horizontalOffset,","verticalOffset: verticalOffset,","startingValueLeft: backgroundPosition[0],","startingValueTop: backgroundPosition[1],","startingBackgroundPositionLeft: (isNaN(parseInt(backgroundPosition[0], 10)) ? 0 : parseInt(backgroundPosition[0], 10)),","startingBackgroundPositionTop: (isNaN(parseInt(backgroundPosition[1], 10)) ? 0 : parseInt(backgroundPosition[1], 10)),","startingPositionLeft: $this.position().left,","startingPositionTop: $this.position().top,","startingOffsetLeft: offsetLeft,","startingOffsetTop: offsetTop,","parentOffsetLeft: parentOffsetLeft,","parentOffsetTop: parentOffsetTop,","stellarRatio: ($this.data('stellar-background-ratio') === undefined ? 1 : $this.data('stellar-background-ratio'))","});","});","},","_reset: function() {","var particle,","startingPositionLeft,","startingPositionTop,","background,","i;","for (i = this.particles.length - 1; i >= 0; i--) {","particle = this.particles[i];","startingPositionLeft = particle.$element.data('stellar-startingLeft');","startingPositionTop = particle.$element.data('stellar-startingTop');","this._setPosition(particle.$element, startingPositionLeft, startingPositionLeft, startingPositionTop, startingPositionTop);","this.options.showElement(particle.$element);","particle.$element.data('stellar-startingLeft', null).data('stellar-elementIsActive', null).data('stellar-backgroundIsActive', null);","}","for (i = this.backgrounds.length - 1; i >= 0; i--) {","background = this.backgrounds[i];","background.$element.data('stellar-backgroundStartingLeft', null).data('stellar-backgroundStartingTop', null);","setBackgroundPosition(background.$element, background.startingValueLeft, background.startingValueTop);","}","},","destroy: function() {","this._reset();","this.$scrollElement.unbind('resize.' + this.name).unbind('scroll.' + this.name);","this._animationLoop = $.noop;","$(window).unbind('load.' + this.name).unbind('resize.' + this.name);","},","_setOffsets: function() {","var self = this,","$window = $(window);","$window.unbind('resize.horizontal-' + this.name).unbind('resize.vertical-' + this.name);","if (typeof this.options.horizontalOffset === 'function') {","this.horizontalOffset = this.options.horizontalOffset();","$window.bind('resize.horizontal-' + this.name, function() {","self.horizontalOffset = self.options.horizontalOffset();","});","} else {","this.horizontalOffset = this.options.horizontalOffset;","}","if (typeof this.options.verticalOffset === 'function') {","this.verticalOffset = this.options.verticalOffset();","$window.bind('resize.vertical-' + this.name, function() {","self.verticalOffset = self.options.verticalOffset();","});","} else {","this.verticalOffset = this.options.verticalOffset;","}","},","_repositionElements: function() {","var scrollLeft = this._getScrollLeft(),","scrollTop = this._getScrollTop(),","horizontalOffset,","verticalOffset,","particle,","fixedRatioOffset,","background,","bgLeft,","bgTop,","isVisibleVertical = true,","isVisibleHorizontal = true,","newPositionLeft,","newPositionTop,","newOffsetLeft,","newOffsetTop,","i;","// First check that the scroll position or container size has changed","if (this.currentScrollLeft === scrollLeft && this.currentScrollTop === scrollTop && this.currentWidth === this.viewportWidth && this.currentHeight === this.viewportHeight) {","return;","} else {","this.currentScrollLeft = scrollLeft;","this.currentScrollTop = scrollTop;","this.currentWidth = this.viewportWidth;","this.currentHeight = this.viewportHeight;","}","// Reposition elements","for (i = this.particles.length - 1; i >= 0; i--) {","particle = this.particles[i];","fixedRatioOffset = (particle.isFixed ? 1 : 0);","// Calculate position, then calculate what the particle's new offset will be (for visibility check)","if (this.options.horizontalScrolling) {","newPositionLeft = (scrollLeft + particle.horizontalOffset + this.viewportOffsetLeft + particle.startingPositionLeft - particle.startingOffsetLeft + particle.parentOffsetLeft) * -(particle.stellarRatio + fixedRatioOffset - 1) + particle.startingPositionLeft;","newOffsetLeft = newPositionLeft - particle.startingPositionLeft + particle.startingOffsetLeft;","} else {","newPositionLeft = particle.startingPositionLeft;","newOffsetLeft = particle.startingOffsetLeft;","}","if (this.options.verticalScrolling) {","newPositionTop = (scrollTop + particle.verticalOffset + this.viewportOffsetTop + particle.startingPositionTop - particle.startingOffsetTop + particle.parentOffsetTop) * -(particle.stellarRatio + fixedRatioOffset - 1) + particle.startingPositionTop;","newOffsetTop = newPositionTop - particle.startingPositionTop + particle.startingOffsetTop;","} else {","newPositionTop = particle.startingPositionTop;","newOffsetTop = particle.startingOffsetTop;","}","// Check visibility","if (this.options.hideDistantElements) {","isVisibleHorizontal = !this.options.horizontalScrolling || newOffsetLeft + particle.width > (particle.isFixed ? 0 : scrollLeft) && newOffsetLeft < (particle.isFixed ? 0 : scrollLeft) + this.viewportWidth + this.viewportOffsetLeft;","isVisibleVertical = !this.options.verticalScrolling || newOffsetTop + particle.height > (particle.isFixed ? 0 : scrollTop) && newOffsetTop < (particle.isFixed ? 0 : scrollTop) + this.viewportHeight + this.viewportOffsetTop;","}","if (isVisibleHorizontal && isVisibleVertical) {","if (particle.isHidden) {","this.options.showElement(particle.$element);","particle.isHidden = false;","}","this._setPosition(particle.$element, newPositionLeft, particle.startingPositionLeft, newPositionTop, particle.startingPositionTop);","} else {","if (!particle.isHidden) {","this.options.hideElement(particle.$element);","particle.isHidden = true;","}","}","}","// Reposition backgrounds","for (i = this.backgrounds.length - 1; i >= 0; i--) {","background = this.backgrounds[i];","fixedRatioOffset = (background.isFixed ? 0 : 1);","bgLeft = (this.options.horizontalScrolling ? (scrollLeft + background.horizontalOffset - this.viewportOffsetLeft - background.startingOffsetLeft + background.parentOffsetLeft - background.startingBackgroundPositionLeft) * (fixedRatioOffset - background.stellarRatio) + 'px' : background.startingValueLeft);","bgTop = (this.options.verticalScrolling ? (scrollTop + background.verticalOffset - this.viewportOffsetTop - background.startingOffsetTop + background.parentOffsetTop - background.startingBackgroundPositionTop) * (fixedRatioOffset - background.stellarRatio) + 'px' : background.startingValueTop);","setBackgroundPosition(background.$element, bgLeft, bgTop);","}","},","_handleScrollEvent: function() {","var self = this,","ticking = false;","var update = function() {","self._repositionElements();","ticking = false;","};","var requestTick = function() {","if (!ticking) {","requestAnimFrame(update);","ticking = true;","}","};","this.$scrollElement.bind('scroll.' + this.name, requestTick);","requestTick();","},","_startAnimationLoop: function() {","var self = this;","this._animationLoop = function() {","requestAnimFrame(self._animationLoop);","self._repositionElements();","};","this._animationLoop();","}","};","$.fn[pluginName] = function (options) {","var args = arguments;","if (options === undefined || typeof options === 'object') {","return this.each(function () {","if (!$.data(this, 'plugin_' + pluginName)) {","$.data(this, 'plugin_' + pluginName, new Plugin(this, options));","}","});","} else if (typeof options === 'string' && options[0] !== '_' && options !== 'init') {","return this.each(function () {","var instance = $.data(this, 'plugin_' + pluginName);","if (instance instanceof Plugin && typeof instance[options] === 'function') {","instance[options].apply(instance, Array.prototype.slice.call(args, 1));","}","if (options === 'destroy') {","$.data(this, 'plugin_' + pluginName, null);","}","});","}","};","$[pluginName] = function(options) {","var $window = $(window);","return $window.stellar.apply($window, Array.prototype.slice.call(arguments, 0));","};","// Expose the scroll and position property function hashes so they can be extended","$[pluginName].scrollProperty = scrollProperty;","$[pluginName].positionProperty = positionProperty;","// Expose the plugin class so it can be modified","window.Stellar = Plugin;","}(jQuery, this, document));"]}]}]]},"ace":{"folds":[],"scrolltop":7269,"scrollleft":0,"selection":{"start":{"row":527,"column":44},"end":{"row":527,"column":44},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":128,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1420702936360,"hash":"c146ca4f02aebd4dbeaf3289cd16aeb3109b3859"}